// First Term Grade Subjects
$first_term_grade_subjects = [
"gk" => $this->Marks->get_student_grade($class_id, 2, 22, $student['id']),
"moral_science" => $this->Marks->get_student_grade($class_id, 2, 23, $student['id']),
"catechism" => $this->Marks->get_student_grade($class_id, 2, 24, $student['id']),
"handwriting" => $this->Marks->get_student_grade($class_id, 2, 27, $student['id']),
"third_language" => $this->Marks->get_student_grade($class_id, 2, 26, $student['id']),
"drawing" => $this->Marks->get_student_grade($class_id, 2, 30, $student['id'])
];

// Annual Term Grade Subjects
$annual_term_grade_subjects = [
"gk" => $this->Marks->get_student_grade($class_id, 4, 22, $student['id']),
"moral_science" => $this->Marks->get_student_grade($class_id, 4, 23, $student['id']),
"catechism" => $this->Marks->get_student_grade($class_id, 4, 24, $student['id']),
"handwriting" => $this->Marks->get_student_grade($class_id, 4, 27, $student['id']),
"third_language" => $this->Marks->get_student_grade($class_id, 2, 26, $student['id']),
"drawing" => $this->Marks->get_student_grade($class_id, 4, 30, $student['id'])
];


// Marks Subject UNIT TEST
$first_unit_test_marks = [
"english_language" => $this->Marks->get_student_marks($class_id, 1, 2, $student['id']),
"english_literature" => $this->Marks->get_student_marks($class_id, 1, 1, $student['id']),
"second_language" => $this->Marks->get_student_marks($class_id, 1, 25, $student['id']),
"mathematics" => $this->Marks->get_student_marks($class_id, 1, 3, $student['id']),
"science" => $this->Marks->get_student_marks($class_id, 1, 4, $student['id']),
"social_studies" => $this->Marks->get_student_marks($class_id, 1, 20, $student['id']),
"computer" => $this->Marks->get_student_marks($class_id, 1, 16, $student['id']),
];

// Marks Subject First Term
$first_term_marks = [
"english_language" => $this->Marks->get_student_marks($class_id, 2, 2, $student['id']),
"english_literature" => $this->Marks->get_student_marks($class_id, 2, 1, $student['id']),
"second_language" => $this->Marks->get_student_marks($class_id, 2, 25, $student['id']),
"mathematics" => $this->Marks->get_student_marks($class_id, 2, 3, $student['id']),
"science" => $this->Marks->get_student_marks($class_id, 2, 4, $student['id']),
"social_studies" => $this->Marks->get_student_marks($class_id, 2, 20, $student['id']),
"computer" => $this->Marks->get_student_marks($class_id, 2, 16, $student['id']),
];

// Marks Subject UNIT TEST
$second_unit_test_marks = [
"english_language" => $this->Marks->get_student_marks($class_id, 3, 2, $student['id']),
"english_literature" => $this->Marks->get_student_marks($class_id, 3, 1, $student['id']),
"second_language" => $this->Marks->get_student_marks($class_id, 3, 25, $student['id']),
"mathematics" => $this->Marks->get_student_marks($class_id, 3, 3, $student['id']),
"science" => $this->Marks->get_student_marks($class_id, 3, 4, $student['id']),
"social_studies" => $this->Marks->get_student_marks($class_id, 3, 20, $student['id']),
"computer" => $this->Marks->get_student_marks($class_id, 3, 16, $student['id']),
];

// Marks Subject First Term
$annual_term_marks = [
"english_language" => $this->Marks->get_student_marks($class_id, 4, 2, $student['id']),
"english_literature" => $this->Marks->get_student_marks($class_id, 4, 1, $student['id']),
"second_language" => $this->Marks->get_student_marks($class_id, 4, 25, $student['id']),
"mathematics" => $this->Marks->get_student_marks($class_id, 4, 3, $student['id']),
"science" => $this->Marks->get_student_marks($class_id, 4, 4, $student['id']),
"social_studies" => $this->Marks->get_student_marks($class_id, 4, 20, $student['id']),
"computer" => $this->Marks->get_student_marks($class_id, 4, 16, $student['id']),
];

$first_term_totals = [
"english_language" => $first_unit_test_marks["english_language"] + $first_term_marks["english_language"],
"english_literature" => $first_unit_test_marks["english_literature"] + $first_term_marks["english_literature"],
"second_language" => $first_unit_test_marks["second_language"] + $first_term_marks["second_language"],
"mathematics" => $first_unit_test_marks["mathematics"] + $first_term_marks["mathematics"],
"science" => $first_unit_test_marks["science"] + $first_term_marks["science"],
"social_studies" => $first_unit_test_marks["social_studies"] + $first_term_marks["social_studies"],
"computer" => $first_unit_test_marks["computer"] + $first_term_marks["computer"],
];

$annual_term_totals = [
"english_language" => $second_unit_test_marks["english_language"] + $annual_term_marks["english_language"],
"english_literature" => $second_unit_test_marks["english_literature"] + $annual_term_marks["english_literature"],
"second_language" => $second_unit_test_marks["second_language"] + $annual_term_marks["second_language"],
"mathematics" => $second_unit_test_marks["mathematics"] + $annual_term_marks["mathematics"],
"science" => $second_unit_test_marks["science"] + $annual_term_marks["science"],
"social_studies" => $second_unit_test_marks["social_studies"] + $annual_term_marks["social_studies"],
"computer" => $second_unit_test_marks["computer"] + $annual_term_marks["computer"],
];


$first_term_avg = [
"english" => ceil(($first_term_totals["english_language"] + $first_term_totals["english_literature"]) / 2),
"second_language" => $first_term_totals["second_language"],
"mathematics" => $first_term_totals["mathematics"],
"science" => $first_term_totals["science"],
"social_studies" => $first_term_totals["social_studies"],
"computer" => $first_term_totals["computer"]
];


$annual_term_avg = [
"english" => ceil(($annual_term_totals["english_language"] + $annual_term_totals["english_literature"]) / 2),
"second_language" => $annual_term_totals["second_language"],
"mathematics" => $annual_term_totals["mathematics"],
"science" => $annual_term_totals["science"],
"social_studies" => $annual_term_totals["social_studies"],
"computer" => $annual_term_totals["computer"]
];

$final_avg = [
"english" => ceil(($first_term_avg["english"] + $annual_term_avg["english"]) / 2),
"second_language" => ceil(($first_term_avg["second_language"] + $annual_term_avg["second_language"]) / 2),
"mathematics" => ceil(($first_term_avg["mathematics"] + $annual_term_avg["mathematics"]) / 2),
"science" => ceil(($first_term_avg["science"] + $annual_term_avg["science"]) / 2),
"social_studies" => ceil(($first_term_avg["social_studies"] + $annual_term_avg["social_studies"]) / 2),
"computer" => ceil(($first_term_avg["computer"] + $annual_term_avg["computer"]) / 2)
];

$first_term_merks_values = array_values($first_term_marks);
$annual_term_merks_values = array_values($annual_term_marks);
$values = array_merge($first_term_merks_values, $annual_term_merks_values);

foreach($values as &$value)
$value = strtolower($value);

if(in_array("ab", $values))
$is_absent = true;

$final_avg_total = $final_avg["english"] + $final_avg["second_language"] + $final_avg["mathematics"] +
$final_avg["science"] + $final_avg["social_studies"] + $final_avg["computer"];
$final_percentage = ceil($final_avg_total / 6);

$division = "";